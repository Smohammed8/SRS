{% extends 'base.html.twig' %}
{% block title %}Patient
{% endblock %}
{% block stylesheets %}
	<style>
		.d-none {
			display: none;
		}
	</style>
{% endblock %}
{% block js%}
	<script>


function toggleCheckIn(route) {
swal.fire({
title: "Are you sure if the patient has taken bed?",
text: "You won't be able to revert this!",
type: "warning",
showCancelButton: true,
confirmButtonText: "Yes, Patient is admitted!"
}).then(function (result) {
$.ajax({
type: "POST",
url: route,
data: {},
dataType: 'json',
success: function (data) {
swal.fire("Patient check-in status changed!", "Waiting Status has been updated.", "success").then(function (result) {
location.reload();
})
}
});
});
}



function toggleImpendingStatus(route) {
swal.fire({
title: "Are you sure?",
text: "You won't be able to revert this!",
type: "warning",
showCancelButton: true,
confirmButtonText: "Yes, change impending status!"
}).then(function (result) {
$.ajax({
type: "POST",
url: route,
data: {},
dataType: 'json',
success: function (data) {
swal.fire("Patient impending status changed!", "Bed Status has been updated.", "success").then(function (result) {
location.reload();
})
}
});
});
}


$(function () {
$('#selectReferal').parent().addClass('d-none');
$('#selectSpecify').parent().addClass('d-none');
$('#selectReason').parent().addClass('d-none');

$('#selectOutcome').on('change', function () {
if ($('#selectOutcome').val() == 6) {

$('#selectReferal').parent().removeClass('d-none');
$('#selectReferal').parent().removeClass('fade');

$('#selectSpecify').parent().removeClass('d-none');
$('#selectSpecify').parent().removeClass('fade');
/////////////////////////////////////
$('#selectReason').parent().removeClass('d-none');
$('#selectReason').parent().removeClass('fade');

//////////////////////////////////////////

} else {
$('#selectReferal').val('').change();

$('#selectReferal').parent().addClass('fade');
$('#selectReferal').parent().addClass('d-none');

$('#selectReason').parent().addClass('fade');
$('#selectReason').parent().addClass('d-none');

$('#selectSpecify').parent().addClass('fade');
$('#selectSpecify').parent().addClass('d-none');
}
})
})
function dischargePatient(admissionId, route) {
$('#formDischarge').attr('action', route);
}

function deleteAdmission(admissionId, route, token) {
swal.fire({
title: "Are you sure?",
text: "You won't be able to revert this!",
type: "warning",
showCancelButton: true,
confirmButtonText: "Yes, Delete it!"
}).then(function (result) {
if (result.value) {
$.ajax({
type: "POST",
url: route,
data: {
'_token': token
},
dataType: 'json',
success: function (data) {
admissionButton = '\
						<a href="#my-modal" role="button" class=" btn btn-sm btn-primary btn-white btn-round"\
						data-toggle="modal">\
								<i class="ace-icon fa fa-bed bigger-120"></i>\
								Admimssion\
							</a>';
                        swal.fire(
                            "Admission deleted!",
                            "Admission has been deleted.",
                            "success"
                        ).then(function(result){
							location.reload();
						})
                        $('#row_admission_' + admissionId).remove();
                        $('#btn_discharge_' + admissionId).remove();
                        $('#patient_action_toolbar').prepend(admissionButton);
                    },
                    error: function (data) {
                        if (data.status) {
                            swal.fire("Forbidden!", "You can't delete this patient admission!", "error");
                        }
                    }
                });
            }
        });
    }

    function submitAdmissionUpdateForm() {
        if ($('#selectUpdateBed').val()) {
            $('#update-modal').addClass('fade');
            $('#update-modal').removeClass('show');
            document.getElementById('formUpdateAdmission').submit();
        } else {}
    }
    function submitAdmissionForm() {
        if ($('#selectBed').val()) {
            $('#my-modal').addClass('fade');
            $('#my-modal').removeClass('show');
            document.getElementById('formAddmission').submit();
        } else {}
    }

    function submitDischargeForm(){
        if ($('#selectOutcome').val()) {
            $('#my-modal').addClass('fade');
            $('#my-modal').removeClass('show');
            document.getElementById('formDischarge').submit();
        }
    }
    function setAdmissionType(type) {
        if(type=='none'){
            $('#re_admission').val('none');
        }else{
            $('#re_admission').val('re-admited');
        }
    }
    $(function () {
        $(document).ready(function () {
            $('.select2').select2();
        });
        $.ajax({
            type: 'GET',
            url: '{{ url("ward_index") }}',
            data: {},
            dataType: "json",
            success: function (response) {
                if (response.data) {
                    $.each(response.data, function (key, value) {
                        $("#selectWard").append('<option value="' + value.id + '">' + value
                            .name + '</option>');
                    });
                }
            }
        });
        $.ajax({
            type: 'GET',
            url: '{{ url("ward_index") }}',
            data: {},
            dataType: "json",
            success: function (response) {
                if (response.data) {
                    $.each(response.data, function (key, value) {
                        $("#selectUpdateWard").append('<option value="' + value.id + '">' + value
                            .name + '</option>');
                    });
                }
            }
        });
        $('#selectWard').on('change', function () {
            var idWard = this.value;
            var wardName = $("#selectWard option:selected").text();
            wardName = wardName.trim();
            $("#selectUnit").html('');
            $("#selectRoom").html('');
            $("#selectBed").html('');
            $.ajax({
                url: "/unit/" + idWard,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    if (response.data) {
                        $('#selectUnit').html('<option value="">Select Unit</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectUnit").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });
        $('#selectUnit').on('change', function () {
            var idUnit = this.value;
            var wardName = $("#selectUnit option:selected").text();
            wardName = wardName.trim();
            $("#selectRoom").html('');
            $("#selectBed").html('');
            $.ajax({
                url: "/room/" + idUnit,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    if (response.data) {
                        $('#selectRoom').html('<option value="">Select Room</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectRoom").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });

        $('#selectRoom').on('change', function () {
            var idRoom = this.value;
            var wardName = $("#selectRoom option:selected").text();
            wardName = wardName.trim();
            $("#selectBed").html('');
            $.ajax({
                url: "/bed/" + idRoom,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    if (response.data) {
                        $('#selectBed').html('<option value="">Select Bed</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectBed").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });




        $('#selectUpdateWard').on('change', function () {
            var idWard = this.value;
            var wardName = $("#selectUpdateWard option:selected").text();
            wardName = wardName.trim();
            $("#selectUpdateUnit").html('');
            $("#selectUpdateRoom").html('');
            $("#selectUpdateBed").html('');
            $.ajax({
                url: "/unit/" + idWard,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    if (response.data) {
                        $('#selectUpdateUnit').html('<option value="">Select Unit</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectUpdateUnit").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });
        $('#selectUpdateUnit').on('change', function () {
            var idUnit = this.value;
            var wardName = $("#selectUpdateUnit option:selected").text();
            wardName = wardName.trim();
            $("#selectUpdateRoom").html('');
            $("#selectUpdateBed").html('');
            $.ajax({
                url: "/room/" + idUnit,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    if (response.data) {
                        $('#selectUpdateRoom').html('<option value="">Select Room</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectUpdateRoom").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });

        $('#selectUpdateRoom').on('change', function () {
            var idRoom = this.value;
            var wardName = $("#selectUpdateRoom option:selected").text();
            wardName = wardName.trim();
            $("#selectUpdateBed").html('');
            $.ajax({
                url: "/bed/" + idRoom,
                type: "GET",
                dataType: 'json',
                success: function (response) {
                    console.log(response.data);
                    if (response.data) {
                        $('#selectUpdateBed').html('<option value="">Select Bed</option>');
                        $.each(response.data, function (key, value) {
                            $("#selectUpdateBed").append('<option value="' + value.id +
                                '">' + value.name + '</option>');
                        });
                    }
                }
            });
        });

    })
</script>

<script>

</script>
{% endblock %}
{% block body %}
{# <form method="POST" action="/admission/{{patient.id}}/discharge">
</form> #}
<br><br><br>
<div class="row">
    <div class="col-xs-12">

        <div>
            <div id="user-profile-1" class="user-profile row">
                <div class="col-xs-12 col-sm-3 center">
                   
                   
                    <div>
                        <span style="border-top:3px solid #438EB9;"  class="profile-picture">
                            <img id="avatar" class="editable img-responsive" wi alt="User Photo"
                                src="{{ asset('assets/images/avatars/profile-pic.jpg')}}" />
                        </span>

                        <div class="space-4"></div>

                        <div class="width-80 label label-info label-xlg arrowed-in arrowed-in-right">
                            <div class="inline position-relative">
                                <a href="#" class="user-title-label dropdown-toggle" data-toggle="dropdown">
                                    {# <i class="ace-icon fa fa-circle light-green"></i> #}
                                
                                    <span title="Click here to see more.." class="white">{{patient.fname}}
                                        {{patient.mname}}
                                        {{patient.lname}}</span>
                                </a>

                            </div>
                        </div>


                    </div>

                    <div class="space-6"></div>

                    <div class="profile-contact-info">
                        <div class="profile-contact-links align-left">


                            <center>
                                Card Number: {{ patient.mrn }}
                            </center>
                            {# <i class="ace-icon fa fa-envelope bigger-125 blue"></i>  {{ patient.kebele }} #}

                        </div>

                        <div class="space-6"></div>


                    </div>

                    <div class="hr hr12 dotted"></div>

                    <div class="clearfix">
                        <div class="grid2">
                            <span class="bigger-120 blue">M
                            </span>

                            <br />
                            Patient Gender
                        </div>
                  {% set age = date().diff(date(patient.dob)).y  %}
                        <div class="grid2">
                            <span class="bigger-120 blue">
                                {{ age }}
                            </span>

                            <br />
                            Current Age
                        </div>
                    </div>

                    <div class="hr hr16 dotted"></div>
                    
                </div>


                <div class="col-xs-12 col-sm-9">
                    <div id="patient_action_toolbar" class="pull-right tableTools-container">
           <!---//////////////////////////////////////////////////////// -->
  {% if is_granted("cret_encounter") %}          
                       <a href="#my-encounter" title="Create Encounter" onclick="event.preventDefault();setAdmissionType('none');" role="button" class=" btn btn-sm btn-primary btn-white btn-round"  data-toggle="modal">
                                        <i class="ace-icon fa fa-user-plus bigger-120"></i>
                                       Encounter
                                    </a>

            {% endif %}
            <!-- //////////////////////////////////////////////// -->
          {% if is_granted("nw_adm") %}     
                        {% if canAdmit ==true %}
                      
                        <a href="#my-modal" title="Create adminssion"  onclick="event.preventDefault();setAdmissionType('none');" role="button" class=" btn btn-sm btn-primary btn-white btn-round"
                            data-toggle="modal">
                            <i class="ace-icon fa fa-bed bigger-120"></i>
                            Admit
                        </a>
                     {% endif %}
           {% endif %}   



   {% if is_granted("add_appntmnt") %}   
                        <a class="btn btn-sm btn-primary btn-white btn-round" title="Make Appointment"
                            href="{{ path('appointment_new', {'id': patient.id}) }}" title="Edit">
                            <i class="ace-icon fa fa-calendar bigger-120"></i>
                           Appoint
                        </a>
     {% endif %}

 {% if is_granted("add_vital") %}  
                        <a class="btn btn-sm btn-primary btn-white btn-round" title="Make Appointment"
                            href="{{ path('vital_sign', {'id': patient.id}) }}" title="Vital sign">
                            <i class="ace-icon fa fa-heartbeat bigger-120"></i>
                           Vital Sign
                        </a>
   {% endif %}

    {% if is_granted("add_prescription") %}  
                        <a class="btn btn-sm btn-primary btn-white btn-round"
                            href="" title="Edit">
                            <i class="ace-icon fa fa-medkit bigger-120"></i>
                              Prescription
                         </a>

                      
   {% endif %}
     {% if is_granted("add_lab") %}  
                        <a class="btn btn-sm btn-primary btn-white btn-round"
                            href="" title="Laboratory">
                            <i class="ace-icon fa fa-flask bigger-120"></i>
                             Lab
                        </a>


      {% endif %}
        
    
             <div class="inline position-relative">

                           
                          {% if is_granted("viw_patient_acction") %}  
                            <a href="#"  class="btn btn-sm btn-primary btn-blue btn-round user-title-label dropdown-toggle" data-toggle="dropdown" title="Edit">
                             <i class="ace-icon fa fa-list bigger-120"></i>   
                              More Details
                              </a>
                           {% endif %}
                                 <ul class="align-left dropdown-menu dropdown-caret dropdown-lighter">
                                 

                       {% if is_granted("viw_encter") %}  
                                   <li>
                                        <a href="{{ path('app_encounter_index',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-user-plus"></i>
                                            &nbsp;
                                            <span class="black">Encounters</span>
                                        </a>
                                    </li>
                          {% endif %}

                            {% if is_granted("vw_admsion") %}  
                                      <li>
                                        <a href="{{ path('view_admimssion',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-bed"></i>
                                            &nbsp;
                                            <span class="black">Admimssions </span>
                                        </a>
                                    </li>

                            {% endif %}
                               {% if is_granted("viw_diagnosis") %}  
                                      <li>
                                        <a href="{{ path('app_assessment_index',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-file"></i>
                                            &nbsp;
                                            <span class="black">  Diagnosis</span>
                                        </a>
                                    </li>
                                {% endif %}
                                   {% if is_granted("viw_apoint") %}  
                                    <li>
                                        <a href="{{ path('appointment_list',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-calendar"></i>
                                            &nbsp;
                                            <span class="black">Appointments</span>
                                        </a>
                                    </li>
                                   {% endif %}

                                     {% if is_granted("viw_atendt") %}  
                                    <li>
                                        <a href="{{ path('visitor_view',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-users"></i>
                                            &nbsp;
                                            <span class="black">Atendants</span>
                                        </a>
                                    </li>
                                       {% endif %}

                               {% if is_granted("view_vital") %}  
                                     <li>
                                        <a href="{{ path('vital_sign', {'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-list"></i>
                                            &nbsp;
                                            <span class="black">Vital signs </span>
                                        </a>
                                    </li>
                                  {% endif %}

                                {% if is_granted("view_lab_order") %}  
                                     <li>
                                        <a href="">
                                            <i class="ace-icon fa fa-medkit"></i>
                                            &nbsp;
                                            <span class="black">Laboratory</span>
                                        </a>
                                    </li>
                                {% endif %}

 	                         {% if is_granted("viw_slip") %}
                                    <li>
                                        <a href="{{ path('slip_view',{'id': patient.id}) }}">
                                            <i class="ace-icon fa fa-file"></i>
                                            &nbsp;
                                            <span class="black">Slips </span>
                                        </a>
                                    </li>
                             {% endif %}
                             
                             {% if is_granted("viw_referral") %}
                                       <li>
                                        <a href="#">
                                            <i class="ace-icon fa fa-institution"></i>
                                            &nbsp;
                                            <span class="black"> Referrals </span>
                                        </a>
                                    </li>
                            {% endif %}

                           

                              {% if is_granted("edit_patient") %}

                                         <li>
                                        <a href="{{ path('patient_edit', {'id': patient.id}) }}"  title="Edit">
                                            <i class="ace-icon fa fa-edit"></i>
                                            &nbsp;
                                            <span class="black">  Edit Profile </span>
                                        </a>
                                           </li>

                                          {% endif %}
                                   
                                </ul>
                            </div>

                    </div>

            
                 

                    <div class="profile-user-info profile-user-info-striped" style="border-top:3px solid #438EB9; ">
                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Full Name</div>

                            <div class="profile-info-value">
                                <span class="editable" id="username">
                                    {{ patient.fname |capitalize}}
                                    {{ patient.mname |capitalize}}
                                    {{ patient.lname |capitalize}}
                                </span>
                            </div>
                        </div>
                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Address
                            </div>
                            <div class="profile-info-value">
                                <!--  <i class="fa fa-map-marker light-orange bigger-110"></i> -->
                                <span class="editable" id="country">{{ patient.address}}</span>

                            </div>
                        </div>

                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Gender
                            </div>

                            <div class="profile-info-value">
                                <span class="editable" id="age">{{ patient.gender }}</span>
                            </div>
                        </div>

                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Date of Birth
                            </div>

                            <div class="profile-info-value">
                                <span class="editable"
                                    id="signup">{{ patient.dob ? patient.dob| eth_date }}</span>
                            </div>
                        </div>
                       
                       
                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Phone
                            </div>

                            <div class="profile-info-value">
                                <span class="editable" id="about">{{ patient.phone }}</span>
                            </div>
                        </div>

                             <div class="profile-info-row">
                            <div class="profile-info-name">
                                Origin
                            </div>

                            <div class="profile-info-value">
                                <span class="editable" id="about">{{ patient.region }}/{{ patient.zone }}/{{ patient.woreda }}</span>
                            </div>
                        </div>


                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Registered at
                            </div>
                            <div class="profile-info-value">
                                <span class="editable" id="about">
                                    {{ patient.createdAt ? patient.createdAt|date('Y-m-d') : '' }}
                                    (
                                    {{ patient.createdAt|ago }})</span>
                            </div>
                        </div>
                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Registered by
                            </div>

                            <div class="profile-info-value">
                                <span class="editable" id="about">{{ patient.user }}</span>
                            </div>
                        </div>

                    
                                 <div class="profile-info-row">
                            <div class="profile-info-name">
                               No of addmissions
                            </div>
                            <div class="profile-info-value">
                                <span class="editable" id="about">
                             {{ patient.admimssions |length }}   
                                   </span>
                                   
                            </div>
                        </div>


                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Appointments
                            </div>

                            <div class="profile-info-value">
                                <span class="editable" id="about">
                                         {{ patient.appointments |length }}  </span>
                            </div>
                        </div>
                        <div class="profile-info-row">
                            <div class="profile-info-name">
                                Initial referral source
                            </div>
                            <div class="profile-info-value">
                                <span class="editable" id="about">
                                    {{ patient.referredfrom }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="space-20"></div>
                </div>
            </div>
        </div>
 
{# <div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(encounters) }}</div>


          <!-- ///////////////////////////-->
    </div><!-- /.col --> #}


<i class="fa fa-user"></i> <u> {{ patient.fname |capitalize}} {{ patient.mname |capitalize}}</u>'s Medical records


    <div class="hr hr10 hr-double" ></div> 


   <div class="widget-box widget-color-white ui-sortable-handle" style="border-left:3px solid #438EB9;">

   <h5 class="alert alert-success"> <i class="fa fa-list"> </i><b> <u> Medical Information </u></b> </h5>

      <div class="widget-body">

<div id="accordion" >

   {% if is_granted("viw_encter") %}
  <div class="card">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseTwo">
        <i class="fa fa-user"></i>   Active Encounters
        </button>
      </h5>
    </div>
    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">

<i class="fa fa-list"></i> Last  <u> {{ patient.fname |capitalize}} {{ patient.mname |capitalize}}</u>'s encounter
        <div class="hr hr10 hr-double" ></div>


<div class="widget-header widget-header-flat" >
<div class="widget-body border-left-3">
  <table class="table" style="border-top:3px solid #438EB9; " >
        <thead>
            <tr>
                <th>#</th>
                <th> Destination Dept </th>
                <th> Encounter type </th>
                <th> User </th>
                <th>Created at</th>
                 <th> Assigned to </th>

                <th> Disease Class</th>
                <th>Referred to </th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for encounter in encounters %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ encounter.destination }}</td>
                <td>{{ encounter.type }}</td>
                <td>{{ encounter.createdBy }}</td>
                <td>{{ encounter.createdAt ? encounter.createdAt|eth_date }}</td>
                <td>{{ encounter.assignedTo ?? '-' }}</td>
                <td>{{ encounter.diseaseCategory }}</td>
                  <td>{{ encounter.referout ?? '-' }}</td>
                <td>



   {% if encounter.referout is null %}

     <a href="#referr-out" onclick="event.preventDefault();" role="button" class=" btn btn-sm btn-primary btn-white btn-round"  data-toggle="modal">
                                        <i class="ace-icon fa fa-send bigger-120"></i>
                                
                                    Refer
                                 
                                    </a>
                                   
                                 {% else %}
                               <a href="#" role="button" class=" btn btn-sm btn-primary btn-white btn-round"  data-toggle="modal">
                                        <i class="ace-icon fa fa-user bigger-120"></i>
                                
                                    Referred
                                 
                                    </a>

                        {% endif %}
                          <a href="#" role="button" class=" btn btn-sm btn-primary btn-white btn-round"  data-toggle="modal">
                                        <i class="ace-icon fa fa-heartbeat bigger-120"></i>
                                
                                    Vital Sign
                                 
                                    </a>
                
                    {% if encounter.referout is null %} 
                    
                    <a class="btn btn-sm btn-primary btn-white btn-round" href="{{ path('app_encounter_edit', {'id': encounter.id}) }}"><i class="fa fa-edit"> </i>  Edit</a>
                   {% endif %}
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="3" style="color:red;">No active encounters found!</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(encounters) }}</div>
</div>

</div>

      </div>
    </div>
  </div>
<!-- ///////////////////////////////////////////////////////-->

{% endif %}

  {% if is_granted("view_vital") %}

  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        <i class="fa fa-heartbeat"></i>   Vital Sign
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">

        <div class="widget-header widget-header-flat">
      <div class="widget-body">

<!-- ////////////////////////////////////////////////////////-->
 

<!-- ///////////////////////////////////////////////////////-->
      </div>
      </div>
      

      </div>
    </div>
  </div>


{% endif %}

  {% if is_granted("vw_admsion") %}

  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
       <i class="fa fa-bed"></i>  Admimssions
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">
      <!--- /////////////////////////////////////////// -->
<div class="widget-header widget-header-flat">
<div class="widget-body">
 <table id="dynamic-table" style="border-top:3px solid #438EB9; " class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th colspan="5">
                        <b>
                            <i class="fa fa-user"></i>
                            Patient Information</b>
                    </th>

                    <th colspan="8">
                        <b>
                            <i class="fa fa-bed"></i>
                            Admission Information</b>
                    </th>
                </tr>
                <tr style="background-color:lightblue;">
                    <th>#</th>
                    <th>MRN</th>
                    <th>Date</th>
                    <th>Age </th>
                    <th>Type</th>

                    <th>Location </th>
                
                    <th>Outcome</th>
                    <th>Status </th>
                    <th>Duration </th>
                    <th>Cost </th>
                     <th>O<sub>2</sub> </th>

                    <th>
                        <i class="ace-icon fa fa-wrench bigger-110"></i>Operations</th>
                </tr>
            </thead>
            <tbody>
                {% for admimssion in admimssions %}
                <tr id="row_admission_{{admimssion.id}}">
                    <td>{{ loop.index }}</td>
                    <td>{{ admimssion.patient.mrn }}</td>
                    <td>
                        {{ admimssion.createdAt ? admimssion.createdAt |eth_date : '' }}
                    </td>
                    <td>{{(date(admimssion.createdAt).diff(date(patient.dob)).days/360)|number_format}}</td>
                    <td>
                        {{ admimssion.type.name }}
                    </td>
                    <td>
                 {{ admimssion.bed.room.unit.ward }}/
                 {{ admimssion.bed.room.unit }}/
                  {{ admimssion.bed.room }}/
                  {{ admimssion.bed }} </td>

                    <td>{{ admimssion.outcome??'-' }}</td>

                    <td>
                      {% if (admimssion.ischeckedIn == 0) and (admimssion.outcome is null) %}
                       <span style="color:red;">  Waiting </span>
                     {% elseif (admimssion.outcome is not null ) %}
                      <span style="color:green;">  Discharged </span>
                      {% else %}
                       <span style="color:green;"> Admitted </span>
                      {% endif %}
                      </td>

                    <td>
                        {% if admimssion.dischargedAt == null%}
                        {{(date(admimssion.createdAt).diff(date('now')).days)|number_format + 1 }} days
                        {% else %}
                        {{(date(admimssion.dischargedAt).diff(admimssion.createdAt).days)|number_format +1 }} days
                        {% endif %}
                    </td>

                        <td> 
                         Birr: 
                      {% if admimssion.dischargedAt == null%}
                       
                        {{ ((date(admimssion.createdAt).diff(date('now')).days)|number_format + 1)* price }} 
                        {% else %}
                        {{ ((date(admimssion.dischargedAt).diff(admimssion.createdAt).days)|number_format +1) * price  }} 
                        {% endif %}
                        
                       
                        
                        </td>


                      {%  if admimssion.needOxgen == 1 %}
                  
                       <td> Yes  </td>

                      {% else %}
                           <td>  - </td>

                      {% endif %}
                    <td>
                        <div class="widget-toolbar no-border">
                            <div class="inline dropdown-hover">
                                <button class="btn btn-sm btn-primary btn-white btn-round">

                                    <b>
                                        <i class="ace-icon fa fa-list bigger-110">&nbsp;</i>
                                        More actions
                                    </b>
                                    <i class="ace-icon fa fa-angle-down icon-on-right bigger-110"></i>
                                </button>

                                <ul class="dropdown-menu dropdown-menu-right dropdown-125 dropdown-lighter dropdown-close dropdown-caret">
                                
                                  {% if is_granted("check_in") %}

                                 {%  if admimssion.ischeckedIn == 0 %} 
                                 

                                          <li>
                                        <a  class="" href="#" onclick="toggleCheckIn('{{path("admimssion_checked_in",{"id":admimssion.id})}}')">
                                            <i class="ace-icon fa fa-bed bigger-110 ">&nbsp;</i>

                                            Check in
                                        </a>
                                    </li>

                                  {% endif %}
                               {% endif %}


                             {% if is_granted("viw_bed_transfer") %}

                                {% if admimssion.dischargedAt == null and admimssion.ischeckedIn == 1  %}
                                 
                                     <li>
                                        <a class="" href="#" >
                                            <i class="ace-icon fa fa-exchange bigger-110">
                                                &nbsp;</i>
                                            Transfer
                                        </a>
                                    </li>

                                  {% endif %}
                              {% endif %}

                               {% if is_granted("print_referral_leter") %}

                                  {% if admimssion.referOut != null and admimssion.outcome != null %}
                                 
                                     <li>
                                        <a class="" href="#" >
                                            <i class="ace-icon fa fa-print bigger-110">
                                                &nbsp;</i>
                                            Print referral letter
                                        </a>
                                    </li>

                                  {% endif %}
                                     {% endif %}
                           
                              {% if is_granted("add_diagnosis") %}

                                {% if admimssion.dischargedAt == null and admimssion.ischeckedIn == 1  %}
                                    <li>
                                        <a class="" href="{{ path('app_assessment_new' ,{'id':patient.id }) }}" >
                                            <i class="ace-icon fa fa-file bigger-110">
                                                &nbsp;</i>
                                            Add diagnosis
                                        </a>
                                    </li>
                             {% endif %}

                               {% endif %}
                                  
                       

                              {% if is_granted("re_admit") %}
                                         {% if admimssion.dischargedAt != null %}
                                          <li>
                
                                            <a class="" href="#my-modal" data-toggle="modal" onclick="event.preventDefault();setAdmissionType('admited');">
                                                <i class="ace-icon fa fa-plus bigger-110">&nbsp;</i>
                                                Re-admit
                                            </a>
                                       <li>
                                    {% endif %}
                                        {% endif %}

                                 {% if is_granted("dscharge_pnt") %}
                                        {% if admimssion.dischargedAt == null and admimssion.ischeckedIn == 1  and admimssion.outcome == null %}
                                        <li>
                                            <a id="btn_discharge_{{admimssion.id}}" href="#discharge-modal" data-toggle="modal" 
                                                onclick="dischargePatient({{admimssion.id}},'{{ path('admimssion_discharge',{id:admimssion.id}) }}')">
                                                <i class="fa fa-bed">&nbsp;</i>
                                                Discharge
                                            </a>
                                        </li>
                                        {% endif %}
                                 {% endif %}

                                   {% if is_granted("add_impending") %}

                                {% if admimssion.dischargedAt == null and admimssion.ischeckedIn == 1  %}
                                    <li>
                                        <a href="#" onclick="toggleImpendingStatus('{{path("admission_toggle_impending_status",{"id":admimssion.id})}}')">
                                            <i class="ace-icon fa fa-refresh bigger-110 ">&nbsp;</i>
                                            {% if admimssion.dischargedAt == null and admimssion.bed.currentStatus == 1 %}
                                                Add to Non-Impending
                                            {% else %}
                                                Add to Impending        
                                            {% endif %}
                                        </a>
                                    </li>
                                {% endif %}
                                         {% endif %}
                          
                                  {% if is_granted("edt_admsion") %}
                                          {% if admimssion.dischargedAt == null  %}
                                       <li>
                                        <a href="#update-modal" data-toggle='modal'>
                                            <i class="ace-icon fa fa-pencil bigger-110 ">&nbsp;</i>
                                            Edit
                                        </a>
                                      </li>
                                       {% endif %}
                                 {% endif %}
                               
                                 {% if is_granted("delt_admsion") %}
                                    
                                      {% if admimssion.dischargedAt == null  %}
                                    <li>
                                        <a href="#"
                                            onclick="deleteAdmission({{admimssion.id}},'{{ path('admimssion_delete', {'id':admimssion.id}) }}','{{ csrf_token('delete' ~ admimssion.id) }}')">
                                            <i class="ace-icon fa fa-trash bigger-110 ">&nbsp;</i>
                                            Delete
                                        </a>
                                    </li>
                                        {% endif %}
                                  {% endif %}

                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
            </tbody>
            </tr>
            {% else %}
            <tr>
                <td colspan="11" style="color:red;">No admimssions record found !</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    <div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(admimssions) }}</div>
    <div>
    </div>
</div>

</div>
      <!-- ///////////////////////////////////////////////////-->
      </div>
    </div>
  </div>
  {% endif %}

    {% if is_granted("viw_apoint") %}
    <div class="card">
    <div class="card-header" id="headingFour">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
         <i class="fa fa-calendar"></i>  Appointment
        </button>
      </h5>
    </div>
    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
      <div class="card-body">
      <!--- ////////////////////////////////////////////////////// -->
 <div class="widget-header widget-header-flat">
<div class="widget-body">
 <table class="table" style="border-top:3px solid #438EB9; ">
	<thead>
		<tr>
			<th>#</th>
			<th>Patient
			</th>
			<th>Reason
			</th>
			<th>Date of visited</th>
			<th>Date of Appointment</th>
			<th>Status
			</th>
			<th>
				Interval
			</th>

			<th>Appointment by
			</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		{% for appointment in appointments %}
			<tr>
				<td>{{ loop.index }}</td>
				<td width="18%">
					<a href=" {{ path('patient_show', {'id': appointment.patient.id }) }}"> {{ appointment.patient }}
					</a>
				</td>
				<td>{{ appointment.reason }}</td>

				<td>{{ appointment.appointAt ? appointment.appointAt| eth_date : '' }}</td>
				<td style="color:red;">{{ appointment.appointedAt ? appointment.appointedAt|eth_date: '' }}</td>
				{% if appointment.status==1 %}
					<td>
						Active
					</td>
				{% else %}
					<td>
						Closed</td>
				{% endif %}

				<td> {{ appointment.totalDays }}
					days</td>
				<td>{{ appointment.user }}</td>
				<td>
           
              {# {% if is_granted("viw_patient_profile") %}
					<a class="btn btn-sm btn-primary btn-white btn-round" href="{{ path('patient_show', {'id': appointment.patient.id }) }}" title="Show Patient">
						<i class="fa fa-user"></i>
						Profile
					</a>
	         {% endif %} #}
			  {% if is_granted("print_appoint") %}
                    	<a class="btn btn-sm btn-primary btn-white btn-round" href="{{ path('print_appointment',{'id':appointment.id }) }}" title="Show Patient">
							<i class="fa fa-print"></i> Print
						</a>

					{% endif %}


					{# <a href="{{ path('appointment_show', {'id': appointment.id}) }}">show</a> #}
					           
	                  {% if is_granted("edt_appnt") %}
                                         <a  class="btn btn-sm btn-warning btn-white btn-round" href="{{ path('appointment_edit', {'id': appointment.id}) }}">Edit</a>
	                  {% endif %}
                </td>
			</tr>
		{% else %}
			<tr>
				<td colspan="6" style="color:red;">No appointments found!</td>
			</tr>
		{% endfor %}
	</tbody>
</table>
    <div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(appointments) }}</div>
</div>
</div>

{# <div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(appointments) }}</div> #}

      <!-- //////////////////////////////////////////////////////-->
      </div>
    </div>
  </div>

{% endif %}
  {% if is_granted("viw_diagnosis") %}
<div class="card">
    <div class="card-header" id="headingFive">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseEight" aria-expanded="false" aria-controls="collapseFive">
           <i class="fa fa-file"></i>  


            Diagnosis
                                        

        </button>
      </h5>
      
    </div>
    <div id="collapseEight" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
      <div class="card-body">

      <div class="widget-header widget-header-flat">
<div class="widget-body">
      <!-- //////////////////////////////////////////////////// -->

    {# <div class="pull-right"> 
    
         <a href=" {{ path('app_assessment_new', {'id': patient.id}) }}" class="btn btn-success btn-sm float-right">  <i class="fa fa-plus"></i> Add Diagnosis</a>
	              
            
		<a href="{{ path('patient_show', {'id': patient.id }) }}" class="btn btn-info btn-sm float-right">  <i class="fa fa-close"></i> Back </a>
	              
		</div> #}

  <h5> <a href="{{ path('patient_show',{'id': patient.id }) }}"> {{ patient }} </a>  's diagnosis </h5>
   
  <table class="table" style="border-top:3px solid #438EB9; ">
        <thead>
            <tr>
                 <th># </th>
                 <th>Clinical Note </th>
                 <th>Uploads </th>
                 <th>Physcian </th>
                 <th>Created at</th>
                 <th>Actions </th>
            </tr>
        </thead>
        <tbody>
        {% for assessment in assessments %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ assessment.note|raw }}</td>

             {% if assessment.file == null %}

                 <td> -   </td>
                  {% else %}
                  <td> <a  class="radius-round bord1er-2 brc-warning-m1" href="{{ asset('assessments/'~ assessment.file)}}"> View Upload      </a>    </td>
                  {% endif %}
                <td>{{ assessment.physcian }}</td>
                <td>{{ assessment.createdAt ? assessment.createdAt| eth_date : '' }}</td>
                <td>

              
                     {% if is_granted("viw_diagnosis") %}
                    <a class="btn btn-sm btn-primary btn-white btn-round" href="{{ path('app_assessment_show', {'id': assessment.id}) }}">
                       <i class="ace-icon fa fa-eye bigger-110">
                                                &nbsp;</i> Show</a>
                                                
                {% endif %}   
                    {% if is_granted("edt_diagnosis") %}                             
                                                 &nbsp;
                    <a  class="btn btn-sm btn-primary btn-white btn-round" href="{{ path('app_assessment_edit', {'id': assessment.id}) }}">   <i class="ace-icon fa fa-edit bigger-110">
                      &nbsp;</i> Edit</a>
                    {% endif %}   
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="3" style="color:red;">No assessment found!</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{# 
<div class="pull-right" style="margin-right:10px;" id="custompaginator">{{ knp_pagination_render(assessments) }}</div> #}


      <!-- //////////////////////////////////////////////////////-->

      </div>
      </div>
      </div>
    </div>
  </div>
  <!--//////////////////////////////////////////// -->

{% endif %}
  {% if is_granted("view_lab_order") %}
  <div class="card">
    <div class="card-header" id="headingSix">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseNine" aria-expanded="false" aria-controls="collapseFive">
           <i class="fa fa-flask"></i>  Lab Examinations
        </button>
      </h5>
      
    </div>
    <div id="collapseNine" class="collapse" aria-labelledby="headingSix" data-parent="#accordion">
      <div class="card-body">

      <div class="widget-header widget-header-flat">
<div class="widget-body">
      <!-- //////////////////////////////////////////////////// -->



      <!-- //////////////////////////////////////////////////////-->

      </div>
      </div>
      </div>
    </div>
  </div>

  <!--//////////////////////////////////////////////-->
{% endif %}

  {% if is_granted("view_prescription") %}

    <div class="card">
    <div class="card-header" id="headingSeven">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTen" aria-expanded="false" aria-controls="collapseFive">
           <i class="fa fa-user-md"></i>  Prescription
        </button>
      </h5>
      
    </div>
    <div id="collapseTen" class="collapse" aria-labelledby="headingSeven" data-parent="#accordion">
      <div class="card-body">
      <div class="widget-header widget-header-flat">
      <div class="widget-body">


      <!-- //////////////////////////////////////////////////// -->



      <!-- //////////////////////////////////////////////////////-->
 
      </div>
      </div>
      </div>
    </div>
  </div>

{% endif %}

  <!--//////////////////////////////////////////////-->
<div>
</div>
</div>
</div> 
</div>
</div>





    <!--  the table block -->
<div id="my-modal" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class="smaller lighter blue no-margin">Add new admimssion</h3>
            </div>
            <div class="modal-body">
                <div>
                    <form id="formAddmission" method="POST" action="{{path('admimssion_new',{patient:patient.id})}}">
                        <div class="row">
                            <div>
                                <input type="hidden" name="patient_id" value="{{patient.id}}">
                                <input type="hidden" name="re_admission" id="re_admission" value="none"/>
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
                            </div>
                            <div class="col-md-12">
                                <label>Ward</label>
                                <select class="select2 form-control" required name="ward" id="selectWard"
                                    style="width:100%;">
                                    <option value=""></option>
                                </select>
                            </div>
                            <div class="col-md-12">
                                <label>Unit</label>
                                <select class="select2 form-control" required name="unit" id="selectUnit"
                                    style="width:100%;"></select>
                            </div>
                            <div class="col-md-12">
                                <label>Room</label>
                                <select class="select2 form-control" required name="room" id="selectRoom"
                                    style="width:100%;">
									</select>
                            </div>
                            <div class="col-md-12">
                                <label>Bed</label>
                                <select class="select2 form-control" required name="bed" id="selectBed"
                                    style="width:100%;"></select>
                            </div>
                            <div class="col-md-12">
                                <label>Emergency Type</label>
                                <select class="select2 form-control" required name="type" id="selectType" style="width:100%;">
                                    {% for type in types %}
                                        <option value="{{type.id}}">{{type.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>

						<div class="col-md-12">
							<label> Need oxgen?</label>
							<select class="select2 form-control" required name="oxgen" id="selectType" style="width:100%;">
							
									<option value="0"> No</option>
                                    <option value="1"> Yes</option>
							
							</select>
						</div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-sm btn-info pull-right" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    Close
                </button>
            {% if is_granted("nw_adm") %}
                <button class="btn btn-sm btn-success pull-right" onclick="submitAdmissionForm()">
                    <i class="ace-icon fa fa-save"></i>
                    Save
                </button>
            {% endif %}
            </div>
        </div>
    </div>
</div>


<div id="update-modal" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class="smaller lighter blue no-margin">Update admimssion</h3>
            </div>
           
           <div class="modal-body">
                <div>
                    <form id="formUpdateAdmission" method="POST" action="{{path('admimssion_edit',{'id':patient.id})}}">
                        <div class="row">
                            <div>
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
                            </div>
                            <div class="col-md-12">
                                <label>Ward</label>
                                <select class="select2 form-control" required name="ward" id="selectUpdateWard"
                                    style="width:100%;">
                                    <option value=""></option>
                                </select>
                            </div>
                            <div class="col-md-12">
                                <label>Unit</label>
                                <select class="select2 form-control" required name="unit" id="selectUpdateUnit"
                                    style="width:100%;"></select>
                            </div>
                            <div class="col-md-12">
                                <label>Room</label>
                                <select class="select2 form-control" required name="room" id="selectUpdateRoom"
                                    style="width:100%;">
									</select>
                            </div>
                            <div class="col-md-12">
                                <label>Bed</label>
                                <select class="select2 form-control" required name="bed" id="selectUpdateBed"
                                    style="width:100%;"></select>
                            </div>
                            <div class="col-md-12">
                                <label>Emergency Type</label>
                                <select class="select2 form-control" required name="type" id="selectUpdateType" style="width:100%;">
                                    {% for type in types %}
                                        <option value="{{type.id}}">{{type.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>

						<div class="col-md-12">
							<label> Need oxgen?</label>
							<select class="select2 form-control" required name="oxgen" id="selectType" style="width:100%;">
							
									<option value="0"> No</option>
                                    <option value="1"> Yes</option>
							
							</select>
						</div>
                        </div>
                    </form>
                </div>
            </div>




            <div class="modal-footer">
                <button class="btn btn-sm btn-info pull-right" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    Close
                </button>
                <button class="btn btn-sm btn-success pull-right" onclick="submitAdmissionUpdateForm()">
                    <i class="ace-icon fa fa-save"></i>
                    Update
                </button>
            </div>
        </div>
    </div>
</div>
<div id="discharge-modal" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class="smaller lighter blue no-margin"> Patient Discharge form </h3>
            </div>
            <div class="modal-body">
                <div>
                    <form id="formDischarge" method="POST" action="">
                        <div class="row">
                            <div class="col-md-12">
                                <label>Outcome</label>
                                <select class="select2 form-control" required name="outcome" id="selectOutcome"
                                    style="width:100%;">
                                    {% for outcome in outcomes %}
                                    <option value="{{outcome.id}}">{{outcome.name}}</option>                                        
                                    {% endfor %}
                                </select>
                            </div>
                           

{#                                 
                            <div class="col-md-12 fade">
                                <label> Referral type </label>
                                <select class="select2 form-control" required name="referal_type" id="xcx" style="width:100%;">
                                        <option value=""> select referral type </option>
                                        <option value="1"> Higher referral</option>
                                        <option value="2"> Back referral</option>
                                </select>
                            </div> #}

                            
                           <br><br>  <br><br>
                            <div class="col-md-12 fade">
                                <label>Where patient is referring to?</label>
                                <select class="select2 form-control" required name="referal" id="selectReferal" style="width:100%;">
                                    <option value=""></option>
                                    {% for referal in referals %}
                                        <option value="{{referal.id}}">{{referal.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>


                               <br><br>  <br><br>
     <!-- ////////////////////////////////////////////////////////////////// -->                      
                              <div class="col-md-12">
                                <label>Select reason of referral</label>
                                <select class="select2 form-control" required name="reason" id="selectReason" style="width:100%;">
                                 {% for reason_of_referral in reason_of_referrals %}
                                        <option value="{{reason_of_referral.id}}">{{reason_of_referral.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <br><br><br><br>
						<div class="col-md-12">
						<label> Please specify the reason to referral out</label> 
                        <br>
						<textarea  cols="50" rows="5" name="specify" id="selectSpecify"/> </textarea>
						</div>
                        </div>

             <!--- ////////////////////////////////////////////////////////// -->

                        </div>
                    </form>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-sm btn-info pull-right" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    Close
                </button>
                <button class="btn btn-sm btn-success pull-right" onclick="submitDischargeForm()">
                    <i class="ace-icon fa fa-save"></i>
                    Save 
                </button>
            </div>
        </div>
    </div>
</div>
<!-- /.col --></div><div id="my-modal" class="modal fade" tabindex="-1">
<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3 class="smaller lighter blue no-margin">Add new admimssion</h3>
		</div>
		<div class="modal-body">
			<div>
				<form id="formAddmission" method="POST" action="{{path('admimssion_new',{patient:patient.id})}}">
					<div class="row">
						<div>
							<input type="hidden" name="patient_id" value="{{patient.id}}">
							<input type="hidden" name="re_admission" id="re_admission" value="none"/>
							<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
						</div>
						<div class="col-md-12">
							<label>Ward</label>
							<select class="select2 form-control" required name="ward" id="selectWard" style="width:100%;">
								<option value=""></option>
							</select>
						</div>
						<div class="col-md-12">
							<label>Unit</label>
							<select class="select2 form-control" required name="unit" id="selectUnit" style="width:100%;"></select>
						</div>
						<div class="col-md-12">
							<label>Room</label>
							<select class="select2 form-control" required name="room" id="selectRoom" style="width:100%;"></select>
						</div>
						<div class="col-md-12">
							<label>Bed</label>
							<select class="select2 form-control" required name="bed" id="selectBed" style="width:100%;"></select>
						</div>

						<div class="col-md-12">
							<label>Emergency Type</label>
							<select class="select2 form-control" required name="type" id="selectType" style="width:100%;">
								{% for type in types %}
									<option value="{{type.id}}">{{type.name}}</option>
								{% endfor %}
							</select>
						</div>



						<div class="col-md-12">
							<label> Need oxgen?</label>
							<select class="select2 form-control" required name="oxgen" id="selectType" style="width:100%;">
							
									<option value="0"> No</option>
                                    <option value="1"> Yes</option>
							
							</select>
						</div>

					</div>
				</form>
			</div>
		</div>

		<div class="modal-footer">
			<button class="btn btn-sm btn-info pull-right" data-dismiss="modal">
				<i class="ace-icon fa fa-times"></i>
				Close
			</button>
			<button class="btn btn-sm btn-success pull-right" onclick="submitAdmissionForm()">
				<i class="ace-icon fa fa-save"></i>
				Save
			</button>
		</div>
	</div>
</div></div><div id="update-modal" class="modal fade" tabindex="-1">
<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3 class="smaller lighter blue no-margin">Add new admimssion</h3>
		</div>
		<div class="modal-body">
			<div>
				<form id="formUpdateAdmission" method="POST" action="">
					<div class="row">
						<div>
							<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
						</div>
						<div class="col-md-12">
							<label>Ward</label>
							<select class="select2 form-control" required name="ward" id="selectUpdateWard" style="width:100%;">
								<option value=""></option>
							</select>
						</div>
						<div class="col-md-12">
							<label>Unit</label>
							<select class="select2 form-control" required name="unit" id="selectUpdateUnit" style="width:100%;"></select>
						</div>
						<div class="col-md-12">
							<label>Room</label>
							<select class="select2 form-control" required name="room" id="selectUpdateRoom" style="width:100%;"></select>
						</div>
						<div class="col-md-12">
							<label>Bed</label>
							<select class="select2 form-control" required name="bed" id="selectUpdateBed" style="width:100%;"></select>
						</div>
						<div class="col-md-12">
							<label>Emergency Type</label>
							<select class="select2 form-control" required name="type" id="selectUpdateType" style="width:100%;">
								{% for type in types %}
									<option value="{{type.id}}">{{type.name}}</option>
								{% endfor %}
							</select>
						</div>


						<div class="col-md-12">
							<label> Need oxgen?</label>
							<select class="select2 form-control" required name="oxgen" id="selectType" style="width:100%;">
							
									<option value="0"> No</option>
                                    <option value="1"> Yes</option>
							
							</select>
						</div>
					</div>
				</form>
			</div>
		</div>

		<div class="modal-footer">
			<button class="btn btn-sm btn-info pull-right" data-dismiss="modal">
				<i class="ace-icon fa fa-times"></i>
				Close
			</button>
			<button class="btn btn-sm btn-success pull-right" onclick="submitAdmissionForm()">
				<i class="ace-icon fa fa-save"></i>
				Save
			</button>
		</div>
	</div>
</div>
</div>



<!-- ////////////////////////////-->


   <!-- ////////////////////////////-->
<div id="my-encounter" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class="smaller lighter blue no-margin">New check in</h3>
            </div>
            <div class="modal-body">
            				<input type="hidden" name="patient_id" value="{{patient.id}}">
							
							<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
                <div>
                    <form id="formEncounter" method="POST" action="{{path('app_encounter_new',{patient:patient.id})}}">
                        <div class="row">
                            <div>
                                <input type="hidden" name="patient_id" value="{{patient.id}}">
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ patient.id) }}">
                            </div>
                         
                            <div class="col-md-12">
                                <label>Encounter Type</label>
                                <select class="select2 form-control" required name="type" id="encounterType" style="width:100%;">
                                     {% for encounter_type in encounter_types %}
                                        <option value="{{encounter_type.id}}">{{encounter_type.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                           
                            <br><br><br><br>
						<div class="col-md-12">
						<label> Which department the patient's distination?</label>
						 <select class="select2 form-control" required name="dept" id="dept" style="width:100%;">
                                     {% for department in departments %}
                                        <option value="{{department.id}}">{{department.name}}</option>
                                    {% endfor %}
                                </select>
						</div>
                    

                            <br><br><br><br>
						<div class="col-md-12">
						<label> Disease Category?</label>
						 <select class="select2 form-control" required name="disease" id="disease" style="width:100%;">
                                     {% for disease_category in disease_categorys %}
                                        <option value="{{disease_category.id}}">{{disease_category.name}}</option>
                                    {% endfor %}
                                </select>
						</div>
                           <br><br><br><br>
                        	<div class="col-md-12">
						<label> Emergency?</label>
					        <input type="checkbox" name="emergency" value="Emergency"/>
						</div>
                        

                        </div>
                    </form>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-sm btn-info pull-right" data-dismiss="modal"> <i class="ace-icon fa fa-times"></i>
                    Close
                </button>
                <button class="btn btn-sm btn-success pull-right" onclick="submitEncounterForm()">
                    <i class="ace-icon fa fa-save"></i>
                    Save
                </button>
            </div>
        </div>
    </div>
</div>
<!--/////////////-->

<script>
   function submitEncounterForm(){
       if ($('#encounterType').val()) {
            $('#formEncounter').addClass('fade');
            $('#formEncounter').removeClass('show');
            document.getElementById('formEncounter').submit();
         }
    }
    </script>
<!--/////////////-->

<div id="discharge-modal" class="modal fade" tabindex="-1">
<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3 class="smaller lighter blue no-margin">Patient Discharge form  </h3>
		</div>
		<div class="modal-body">
			<div>
				<form id="formDischarge" method="POST" action="">
					<div class="row">
						<div class="col-md-12">
							<label>Outcome</label>
							<select class="select2 form-control" required name="outcome" id="selectOutcome" style="width:100%;">
								{% for outcome in outcomes %}
									<option value="{{outcome.id}}">{{outcome.name}}</option>
								{% endfor %}
							</select>
						</div>
                        <br>  <br>
						<div class="col-md-12 fade">
							<label>Where patient is referring to?</label>
							<select class="select2 form-control" required name="referal" id="selectReferral" style="width:100%;">
								<option value=""></option>
								{% for referal in referals %}
									<option value="{{referal.id}}">{{referal.name}}</option>
								{% endfor %}
							</select>
						</div>
                              <br>  <br>
                     <!-- ////////////////////////////////////////////////////////////////// -->                      
                              <div class="col-md-12">
                                <label>Select reason of referral</label>
                                <select class="select2 form-control" required name="reason" id="selectReason" style="width:100%;">
                                 {% for reason_of_referral in reason_of_referrals %}
                                        <option value="{{reason_of_referral.id}}">{{reason_of_referral.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <br><br><br><br>
						<div class="col-md-12">
						<label> Please specify the reason to referral out</label> 
                        <br>
						<textarea  cols="50" rows="5" name="specify" id="selectSpecify"> </textarea>
						</div>
                        </div>

                  <!--- ////////////////////////////////////////////////////////// -->
					</div>
				</form>
			</div>
		</div>


{% endblock %}
